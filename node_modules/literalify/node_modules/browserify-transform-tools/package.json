{
  "name": "browserify-transform-tools",
  "version": "1.2.2",
  "description": "Utilities for writing browserify transforms.",
  "main": "./lib/transformTools.js",
  "repository": {
    "type": "git",
    "url": "https://github.com/benbria/browserify-transform-tools.git"
  },
  "keywords": [
    "browserify",
    "transform",
    "utilities"
  ],
  "author": {
    "name": "Jason Walton",
    "url": "https://github.com/jwalton"
  },
  "contributors": [
    {
      "name": "Jason Walton",
      "email": "dev@lucid.thedreaming.org",
      "url": "https://github.com/jwalton"
    }
  ],
  "license": "MIT",
  "directories": {
    "lib": "./lib"
  },
  "dependencies": {
    "through": "~2.3.4",
    "falafel": ">0.2.1"
  },
  "devDependencies": {
    "coffee-script": "1.6.3",
    "mocha": "1.15.0",
    "browserify": "~3.14.1",
    "async": "~0.2.9"
  },
  "scripts": {
    "test": "cake test",
    "prepublish": "cake build",
    "build": "cake build"
  },
  "readme": "This package contains tools for helping you write [transforms](https://github.com/substack/node-browserify#btransformtr) for [browserify](https://github.com/substack/node-browserify).\n\nMany different transforms perform certain basic functionality, such as turning the contents of a stream into a string, or loading configuration from package.json.  This package contains helper methods to perform these common tasks, so you don't have to write them over and over again:\n\n* `makeStringTransform()` creates a transform which consumes and returns a string, instead of using a stream.\n* `makeFalafelTransform()` parses a JS file using [falafel](https://github.com/substack/node-falafel) and allows you to modify the code.\n* `makeRequireTransform()` passes you the contents of each `require()` call in each script, and allows you to rewrite the require statement.\n* All of the above will automatically search for transform configuration in package.json and pass it to you if available, but if you have a more complicated use case than the `make*Transform()` functions will support, then `loadTransformConfig()` will load configuration for you.\n* `runTransform()` can be used to unit test your shiny new transform.\n\n\nInstallation\n============\n\nInstall with `npm install --save browserify-transform-tools`.\n\nCreating a String Transform\n===========================\nBrowserify transforms work on streams.  This is all well and good, until you want to call a library like \"falafel\" which doesn't work with streams.  (If you're using falafel specifically, see below for `makeFalafelTransform`.)\n\nSuppose you are writing a transform called \"unbluify\" which replaces all occurances of \"blue\" with a color loaded from a configuration:\n\n```JavaScript\nvar options = {excludeExtensions: [\".json\"]};\nmodule.exports = transformTools.makeStringTransform(\"unbluify\", options,\n    function (content, transformOptions, done) {\n        var file = transformOptions.file;\n        if(!transformOptions.config) {\n            return done(new Error(\"Could not find unbluify configuration.\"));\n        }\n\n        done(null, content.replace(/blue/g, transformOptions.config.newColor));\n    });\n```\n\nNotice that the color we replace \"blue\" with gets loaded from configuration.  The configuration\ncan be set in a variety of ways.  A simple example is to set it directly in package.json:\n\n```JavaScript\n{\n    \"name\": \"myProject\",\n    \"version\": \"1.0.0\",\n    ...\n    \"unbluify\": {\"newColor\": \"red\"}\n}\n```\n\nSee the section on \"Loading Configuration\" below for details on where configuration can be loaded from.\n\nParameters for `makeStringTransform()`:\n\n* `transformFn(contents, transformOptions, done)` - Function which is called to\n  do the transform.  `contents` are the contents of the file.  `done(err, transformed)` is\n  a callback which must be called, passing the a string with the transformed contents of the\n  file.  transformOptions consists of:\n\n  * `transformOptions.file` is the name of the file (as would be passed to a normal browserify transform.)\n\n  * `transformOptions.configData` is the configuration data for the transform (see\n  `loadTransformConfig` below for details on where this comes from.)\n\n  * `transformOptions.config` is a copy of `transformOptions.configData.config` for convenience.\n\n* `options.excludeExtensions` - A list of extensions which will not be processed.  e.g.\n  \"['.coffee', '.jade']\"\n\n* `options.includeExtensions` - A list of extensions to process.  If this options is not\n  specified, then all extensions will be processed.  If this option is specified, then\n  any file with an extension not in this list will skipped.\n\n* `options.jsFilesOnly` - If set true, then your transform will only run on \"javascript\" files.\n  This is handy for Falafel and Require transforms, defined below.  This is equivalent to\n  passing\n  `includeExtensions: [\".js\", \".coffee\", \".coffee.md\", \".litcoffee\", \"._js\", \"._coffee\"]`.\n\nCreating a Falafel Transform\n============================\nMany transforms are based on [falafel](https://github.com/substack/node-falafel). browserify-transform-tools provides an easy way to define such transforms.  Here is an example which wraps all array expressions in a call to `fn()`:\n\n```JavaScript\nvar options = {};\n// Wraps all array expressions in a call to fn().  e.g. '[1,2,3]' becomes 'fn([1,2,3])'.\nmodule.exports = transformTools.makeFalafelTransform(\"array-fnify\", options,\n    function (node, transformOptions, done) {\n        if (node.type === 'ArrayExpression') {\n            node.update('fn(' + node.source() + ')');\n        }\n        done();\n    });\n```\n\n`makeFalafelTransform()` will be called once for every node in your JS file.  You can update the node.  Be sure to pass errors back via `done(err)`, and call `done()` when complete.\n\nOptions passed to `makeFalafelTransform()` are the same as for `makeStringTransform()`, as are the transformOptions passed to the transform function.  You can additionally pass a `options.falafelOptions` to `makeFalafelTransform` - this object will be passed as an options object directly to falafel.\n\nCreating a Require Transform\n============================\n\nMany transforms are focused on transforming `require()` calls.  browserify-transform-tools has a solution for this:\n\n```JavaScript\ntransform = transformTools.makeRequireTransform(\"requireTransform\",\n    {evaluateArguments: true},\n    function(args, opts, cb) {\n        if (args[0] === \"foo\") {\n            return cb(null, \"require('bar')\");\n        } else {\n            return cb();\n        }\n    });\n```\n\nThis will take all calls to `require(\"foo\")` and transform them to `require('bar')`.  Note that makeRequireTransform can parse many simple expressions, so the above would succesfully parse `require(\"f\" + \"oo\")`, for example.  Any expression involving core JavaScript, `__filename`, `__dirname`, `path`, and `join` (where join is an alias for `path.join`) can be parsed.  Setting the `evaluateArguments` option to false will disable this behavior, in which case the source code for everything inside the ()s will be returned.\n\nNote that `makeRequireTransform` expects your function to return the complete `require(...)` call.  This makes it possible to write require transforms which will, for example, inline resources.\n\nAgain, all other options you can pass to `makeStringTransform` are valid here, too.\n\nLoading Configuration\n=====================\n\nAll `make*Transform()` functions will automatically load configuration for your transform and make it available via `transformOptions.config` (and through the more detailed `transformOptions.configData`.)  Functions are also provided for reading configuration if you are not using one of the `make*Transform()` functions.\n\nTransform configuration can be loaded from a project's package.json file, from a js or coffee file specified in package.json, or programatically.  For details, see [the transform configuration documentation](https://github.com/benbria/browserify-transform-tools/wiki/Transform-Configuration).\n\nRunning a Transform\n===================\nIf you want to unit test your transform, then `runTransform()` is for you:\n\n```JavaScript\nvar myTransform = transformTools.makeFalafelTransform(...);\nvar dummyJsFile = path.resolve(__dirname, \"../testFixtures/testWithConfig/dummy.js\");\nvar content = \"console.log('Hello World!');\";\ntransformTools.runTransform(myTransform, dummyJsFile, {content: content},\n    function(err, transformed) {\n        // Verify transformed is what we expect...\n    }\n);\n```\n\nThanks\n======\nSome of this was heavily inspired by:\n\n* [ForbesLindesay](https://github.com/ForbesLindesay)'s [rfileify](https://github.com/ForbesLindesay/rfileify)\n* [thlorenz](https://github.com/thlorenz)'s [browserify-shim](https://github.com/thlorenz/browserify-shim)\n\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/benbria/browserify-transform-tools/issues"
  },
  "homepage": "https://github.com/benbria/browserify-transform-tools",
  "_id": "browserify-transform-tools@1.2.2",
  "_shasum": "6105a97d88b8ef33121ba374fa05d2af3dd263dd",
  "_from": "browserify-transform-tools@~1.2",
  "_resolved": "https://registry.npmjs.org/browserify-transform-tools/-/browserify-transform-tools-1.2.2.tgz"
}
